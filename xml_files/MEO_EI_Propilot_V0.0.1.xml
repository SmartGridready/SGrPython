<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="/xsl/SGr.xsl"?>
<sgr:SGrRestAPIDeviceFrame
	deviceName="meoEnergy PROPILOT" isLocalControl="false"
	manufacturerID="meoENERGY" manufacturerName="meoEnergy"
	xmlns:sgr="http://www.smartgridready.com/ns/V0/"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.smartgridready.com/ns/V0/ ../../SchemaDatabase/SGr/EI-RestAPI/SGrRestAPI_EIDeviceFrame.xsd"
>	<sgr:releaseNotes>
		<sgr:state>Review</sgr:state>
		<sgr:changelog>
			<sgr:version>0.2.2</sgr:version>
			<sgr:date>2023-01-16</sgr:date>
			<sgr:author>Martin Zwinz, Meo Energy</sgr:author>
			<sgr:comment>Creation based on input from meoEnergy</sgr:comment>
		</sgr:changelog>
	</sgr:releaseNotes>
	<sgr:deviceProfile>
		<sgr:transportService>RESTfulJSON</sgr:transportService>
		<sgr:deviceKind>SubMeterElectricity</sgr:deviceKind>
		<sgr:softwareRevision>
			<sgr:primaryVersionNumber>1</sgr:primaryVersionNumber>
			<sgr:secondaryVersionNumber>0</sgr:secondaryVersionNumber>
			<sgr:subReleaseVersionNumber>0</sgr:subReleaseVersionNumber>
		</sgr:softwareRevision>
		<sgr:manufSpecIdent>sgr:manufSpecIdent</sgr:manufSpecIdent>
	</sgr:deviceProfile>

	<sgr:restAPIInterfaceDesc>
		<sgr:restAPIInterfaceSelection>trspSrvRestURI</sgr:restAPIInterfaceSelection>
		<sgr:trspSrvRestURIoutOfBox>https://my.meo-energy.com/meoApplicationServer</sgr:trspSrvRestURIoutOfBox>
		<sgr:restAPIAuthenticationMethod>BearerSecurityScheme</sgr:restAPIAuthenticationMethod>
		<sgr:restAPIBearer>
			<sgr:serviceCall>
				<sgr:requestHeader>
					<sgr:header headerName="Accept" value="application/json" />
				</sgr:requestHeader>
				<sgr:requestMethod>POST</sgr:requestMethod>
				<sgr:requestPath>/authentication</sgr:requestPath>
				<sgr:requestBody>{"email": "{{username}}", "password": "{{password}}"}</sgr:requestBody>
				<sgr:responseQuery>
					<sgr:queryType>JMESPathExpression</sgr:queryType>
					<sgr:query>accessToken</sgr:query>
				</sgr:responseQuery>
			</sgr:serviceCall>
		</sgr:restAPIBearer>
	</sgr:restAPIInterfaceDesc>

	<sgr:fpListElement>
		<sgr:functionalProfile profileName="ActivePowerAC">
			<sgr:profileNumber>
				<sgr:specsOwnerId>0</sgr:specsOwnerId>
				<sgr:profileIdentification>NonSpecific</sgr:profileIdentification>
				<sgr:subProfileIdent>ActivePowerAC</sgr:subProfileIdent>
				<sgr:sgrLevelOfOperation>m</sgr:sgrLevelOfOperation>
				<sgr:versionNumber>
					<sgr:primaryVersionNumber>1</sgr:primaryVersionNumber>
					<sgr:secondaryVersionNumber>0</sgr:secondaryVersionNumber>
					<sgr:subReleaseVersionNumber>0</sgr:subReleaseVersionNumber>
				</sgr:versionNumber>
			</sgr:profileNumber>
		</sgr:functionalProfile>
		<sgr:dpListElement>
			<sgr:dataPoint datapointName="ActivePowerACtot" mroVisibilityIndicator="R"
				rwpDatadirection="R" unit="KILOWATTS">
				<sgr:basicDataType>
					<sgr:float32>0</sgr:float32>
				</sgr:basicDataType>
				<sgr:dpLegibDesc>
					<sgr:textElement>Erfassung der gesamten Wirkleistung</sgr:textElement>
					<sgr:language>de</sgr:language>
				</sgr:dpLegibDesc>
			</sgr:dataPoint>
			<sgr:restAPIDataPoint dataType="JSON_number">
				<sgr:restServiceCall>
					<sgr:requestHeader>
						<sgr:header headerName="Accept" value="application/json" />
					</sgr:requestHeader>
					<sgr:requestMethod>GET</sgr:requestMethod>
					<sgr:requestPath>/sgr/cem/measurements?serialNo={{serialNo}}</sgr:requestPath>
					<sgr:responseQuery>
						<sgr:queryType>JMESPathExpression</sgr:queryType>
						<sgr:query>activePowerACtot</sgr:query>
					</sgr:responseQuery>
				</sgr:restServiceCall>
			</sgr:restAPIDataPoint>
		</sgr:dpListElement>
	</sgr:fpListElement>
</sgr:SGrRestAPIDeviceFrame>